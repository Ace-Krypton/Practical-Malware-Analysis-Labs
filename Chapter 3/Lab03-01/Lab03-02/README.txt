File Name: Lab03-03.dll
File Type: PE32

1-> How can you get this malware to install itself?
- Using PE-bear we are able to easily see the exports of this DLL file.
- When comparing this with the imports shown in PEview it becomes quite clear that this DLL needs to be installed as a service.
- Interesting Strings while analysing this malware
|-> - InternetReadFile
    - HttpQueryInfoA
    - HttpSendRequestA
    - HttpOpenRequestA
    - InternetConnectA
    - InternetOpenA
    - InternetCloseHandle
    - Install
    - ServiceMain
    - UninstallService
    - installA
    - uninstallA
    - Windows XP 6.11
    - %SystemRoot%\System32\svchost.exe -k 
    - SYSTEM\CurrentControlSet\Services\
    - Intranet Network Awareness (INA+)
    - %SystemRoot%\System32\svchost.exe -k netsvcs
    - IPRIP

- for running dll we use this command: rundll32.exe Lab03-02.dll,install
- By using regshot we’re easily able to see the registry keys which have been modified by running the DLL.


2-> How would you get this malware to run after installation?
- Given this has installed as a service
- Name is IPRIP we can run it through either the net utility, or SC Tool: sc start IPRIP or net start IPRIP


3-> How can you find the process under which this malware is running?
- By searching for the specified DLL, or looking at the DLLs loaded by a process in Process Explorer,
- we’re able to get the process ID of the svchost process which is running this malware.
- ID is 1068


4-> Which filters could you set in order to use procmon to glean information?
- Because there’s likely to be multiple svchost processes
- we can filter by the Process ID to glean information only on the svchost process responsible for running this malware.


5-> What are the malware’s host-based indicators?
- IPRIP
- Intranet Network Awareness (INA+)
- Depends INA+, Collects and stores network configuration and location information, and notifies applications when this information changes.
- HKLM\SYSTEM\CurrentControlSet\Services\IPRIP\Parameters\ /v servicedll


6-> Are there any useful network-based signatures for this malware?
- practicalmalwareanalysis.com
- port 80
- serve.html
- User-Agent %ComputerName% Windows XP 6.11