File Name: Lab01-04.exe
File Type: PE32

1-> Upload the Lab01-04.exe file to http://www.VirusTotal.com/. Does it match any existing antivirus definitions?

- 59/72 detection rate


2-> Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.

- There are no indications this file is packed or obfuscated, PEiD identifies it was created with Microsoft Visual C++ 6.0, PEview shows similar virtual and raw data size, and dependency walker shows a number of imports.


3-> When was this program compiled?

- Friday, 30.08.2019 22:26:59 UTC


4-> Do any imports hint at this program’s functionality? If so, which imports are they and what do they tell you?

- Based on the imports from Kernel32 we can see that this will load resources from the file’s resource section and write files to disk. Based on the GetWindowsDirectory function we can assume this will write files to the system directory, and will then execute them due to the WinExec function.

- The imports from Advapi32 indicate that this is attempting to modify or change the token assigned to the execution of this process, presumably to elevate privileges or give extended access rights.


5-> What host-based or network-based indicators could be used to identify this malware on infected machines?

- Looking into the strings of this file, we can see an entry for the following host indicators:

- winup.exe
- system32\wupdmgrd.exe

- The strings also indicate the below network-based url which may be where a malware updater or second stage payload is pulled from.

- http://practicalmalwareanalysis.com/updater.exe


6-> This file has one resource in the resource section. Use Resource Hacker to examine that resource, and then use it to extract the resource. What can you learn from the resource?

- Looking at this resource through Resource Hacker, we can see that it has a header which indicates it is an embedded executable.

- By saving this as a binary (executable) file, we can then open it in PE-bear and see this is the file which not only contains the winexec imported function of kernel32, but also the URLDownloadToFile function of URLMON.DLL which indicates it will likely download and execute a file.